/*
 * Switch_SJA1105.c
 *
 *  Created on: 2019Äê10ÔÂ23ÈÕ
 *      Author: admin
 */

#include <stdlib.h>
#include <string.h>
#include "Switch_SJA1105.h"
#include "Spi.h"



static uint8_t r_data[65 * 4] = {0};


///* General Config */
#if 0
/*
 * P0 --> P2 & P3 (0x0C), Port0 MII interface, MAC mode.
 * P1 --> None (0x0),  	  Port1 Unused.
 * P2 --> P0 & P3 (0x09), Port2 MII interface, MAC mode.
 * P3 --> P0 & P2 (0x05), Port3 MII interface, MAC mode.
 * P4 --> None (0x0),  	  Port4 Unused.
 */
/* PING demo test. */
static uint8_t configBurst0_0[65*4] = {0x80,0x20,0x00,0x00, 0xAF,0x00,0x03,0x0E, 0x05,0x00,0x00,0x00, 0x00,0x00,0x00,0x05, 0x9A,0x1C,0xA0,0x2B, 0x26,0x42,0x00,0x00, 0x04,0x25,0x00,0x00, 0xFF,0xF8,0x00,0x00, 0xFF,0xFF,0xFF,0xFF, 0x00,0x00,0xFF,0xFF, 0x00,0xF1,0xAB,0x13, 0x06,0x00,0x00,0x00, 0x00,0x00,0x00,0x5A, 0x4E,0xD2,0xC5,0x0F, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00};
static uint8_t configBurst0_1[65*4] = {0x80,0x20,0x04,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xA3,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xA7,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xAB,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xAF,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xB3,0xFF,0xFF,0xFF, 0x99,0xCE,0x35,0xDC, 0x07,0x00,0x00,0x00, 0x00,0x00,0x00,0x02, 0x7D,0x0B,0xCB,0xF2, 0x00,0x00,0x00,0x00, 0x00,0x3F,0xF0,0x00, 0x88,0x38,0x86,0x85, 0x08,0x00,0x00,0x00, 0x00,0x00,0x00,0x1A, 0x6A,0xF6,0x23,0x53, 0x10,0x00,0x00,0x00, 0x63,0x19,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x00,0x01,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x4A,0x53,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x29,0x4B,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x00,0x01,0xF5,0x8D, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00};
static uint8_t configBurst0_2[65*4] = {0x80,0x20,0x08,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0xFC,0xAA,0x73,0x1A, 0x09,0x00,0x00,0x00, 0x00,0x00,0x00,0x28, 0x0D,0xB4,0x3A,0xC9, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x9E,0x02,0x22,0x4A, 0x0D,0x00,0x00,0x00, 0x00,0x00,0x00,0x04, 0x12,0xD0,0x8C,0x8F, 0x02,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x04,0x00,0x80,0x10, 0x00,0x01,0x00,0x20, 0x34,0xE3,0x1D,0x78};
static uint8_t configBurst0_3[39*4] = {0x80,0x20,0x0C,0x00, 0x0E,0x00,0x00,0x00, 0x00,0x00,0x00,0x03, 0xC8,0xA7,0xCE,0xE6, 0x00,0x71,0xC0,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0xC3,0xF7,0x04,0xB9, 0x10,0x00,0x00,0x00, 0x00,0x00,0x00,0x04, 0x8A,0xA0,0xDF,0xBC, 0x80,0x00,0x00,0x00, 0x0D,0xF0,0x3F,0xFB, 0xB2,0xB7,0x80,0x98, 0x40,0x98,0x0D,0xF7, 0xE6,0xC9,0x31,0x8C, 0x11,0x00,0x00,0x00, 0x00,0x00,0x00,0x0B, 0xEF,0xA3,0xE6,0x5A, 0x01,0xC0,0x00,0x00, 0x42,0x04,0x00,0x00, 0xFF,0xFF,0xFC,0x45, 0xFF,0xFF,0xFF,0xFF, 0xFF,0xDD,0x37,0xFF, 0xFF,0xFF,0x00,0x00, 0x00,0x00,0xFF,0xFF, 0x0E,0xFF,0xFF,0xFF, 0x80,0xC2,0x00,0x00, 0x00,0x00,0x03,0x01, 0x45,0x01,0x80,0xC2, 0xD7,0xC6,0x8C,0x8D, 0x4E,0x00,0x00,0x00, 0x00,0x00,0x00,0x01, 0x3A,0x5D,0x5E,0x24, 0xE0,0x30,0x00,0x00, 0x5E,0x08,0x0B,0x97, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x9D,0xB7,0xE6,0xFD};
#endif


#if 1
/*
 * P0 --> P4 (1 << 4), Port0 MII interface, MAC mode.
 * P1 --> None (0x0),  Port1 Unused.
 * P2 --> P4 (1 << 4), Port2 MII interface, MAC mode.
 * P3 --> P4 (1 << 4), Port3 MII interface, MAC mode.
 * P4 --> P0 & P2 & P3 (0x0D), Port4 MII interface, PHY mode.
 */
static uint8_t configBurst0_0[65*4] = {0x80,0x20,0x00,0x00, 0xAF,0x00,0x03,0x0E, 0x05,0x00,0x00,0x00, 0x00,0x00,0x00,0x05, 0x9A,0x1C,0xA0,0x2B, 0x26,0x42,0x00,0x00, 0x04,0x25,0x00,0x00, 0xFF,0xF8,0x00,0x00, 0xFF,0xFF,0xFF,0xFF, 0x00,0x00,0xFF,0xFF, 0x00,0xF1,0xAB,0x13, 0x06,0x00,0x00,0x00, 0x00,0x00,0x00,0x5A, 0x4E,0xD2,0xC5,0x0F, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00};
static uint8_t configBurst0_1[65*4] = {0x80,0x20,0x04,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xA3,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xA7,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xAB,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xAF,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xB3,0xFF,0xFF,0xFF, 0x99,0xCE,0x35,0xDC, 0x07,0x00,0x00,0x00, 0x00,0x00,0x00,0x02, 0x7D,0x0B,0xCB,0xF2, 0x00,0x00,0x00,0x00, 0x00,0x3F,0xF0,0x00, 0x88,0x38,0x86,0x85, 0x08,0x00,0x00,0x00, 0x00,0x00,0x00,0x1A, 0x6A,0xF6,0x23,0x53, 0x10,0x00,0x00,0x00, 0x84,0x21,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x00,0x01,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x84,0x21,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x84,0x21,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x6B,0x5B,0xF5,0x8D, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00};
static uint8_t configBurst0_2[65*4] = {0x80,0x20,0x08,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0xF4,0x4E,0xF6,0xED, 0x09,0x00,0x00,0x00, 0x00,0x00,0x00,0x28, 0x0D,0xB4,0x3A,0xC9, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x9E,0x02,0x22,0x4A, 0x0D,0x00,0x00,0x00, 0x00,0x00,0x00,0x04, 0x12,0xD0,0x8C,0x8F, 0x02,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x04,0x00,0x80,0x10, 0x00,0x01,0x00,0x20, 0x34,0xE3,0x1D,0x78};
static uint8_t configBurst0_3[39*4] = {0x80,0x20,0x0C,0x00, 0x0E,0x00,0x00,0x00, 0x00,0x00,0x00,0x03, 0xC8,0xA7,0xCE,0xE6, 0x00,0x71,0xC0,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0xC3,0xF7,0x04,0xB9, 0x10,0x00,0x00,0x00, 0x00,0x00,0x00,0x04, 0x8A,0xA0,0xDF,0xBC, 0x80,0x00,0x00,0x00, 0x0D,0xF0,0x3F,0xFB, 0xB2,0xB7,0x80,0x98, 0x40,0x98,0x0D,0xF7, 0xE6,0xC9,0x31,0x8C, 0x11,0x00,0x00,0x00, 0x00,0x00,0x00,0x0B, 0xEF,0xA3,0xE6,0x5A, 0x01,0xC0,0x00,0x00, 0x42,0x04,0x00,0x00, 0xFF,0xFF,0xFC,0x45, 0xFF,0xFF,0xFF,0xFF, 0xFF,0xDD,0x37,0xFF, 0xFF,0xFF,0x00,0x00, 0x00,0x00,0xFF,0xFF, 0x0E,0xFF,0xFF,0xFF, 0x80,0xC2,0x00,0x00, 0x00,0x00,0x03,0x01, 0x45,0x01,0x80,0xC2, 0xD7,0xC6,0x8C,0x8D, 0x4E,0x00,0x00,0x00, 0x00,0x00,0x00,0x01, 0x3A,0x5D,0x5E,0x24, 0x80,0x30,0x00,0x00, 0x13,0xBA,0x6A,0xCF, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x9D,0xB7,0xE6,0xFD};
#endif


#if 0
/*
 * P0 --> None (0x0),  Port0 Unused.
 * P1 --> None (0x0),  Port1 Unused.
 * P2 --> P4 (1 << 4), Port2 MII interface, MAC mode.
 * P3 --> P4 (1 << 4), Port3 MII interface, MAC mode.
 * P4 --> P3 (1 << 3), Port4 MII interface, PHY mode.
 */
static uint8_t configBurst0_0[65*4] = {0x80,0x20,0x00,0x00, 0xAF,0x00,0x03,0x0E, 0x05,0x00,0x00,0x00, 0x00,0x00,0x00,0x05, 0x9A,0x1C,0xA0,0x2B, 0x26,0x42,0x00,0x00, 0x04,0x25,0x00,0x00, 0xFF,0xF8,0x00,0x00, 0xFF,0xFF,0xFF,0xFF, 0x00,0x00,0xFF,0xFF, 0x00,0xF1,0xAB,0x13, 0x06,0x00,0x00,0x00, 0x00,0x00,0x00,0x5A, 0x4E,0xD2,0xC5,0x0F, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x03,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x07,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0B,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00};
static uint8_t configBurst0_1[65*4] = {0x80,0x20,0x04,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x0F,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0x13,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xA3,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xA7,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xAB,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xAF,0xFF,0xFF,0xFF, 0xFE,0xFB,0x00,0x00, 0xB3,0xFF,0xFF,0xFF, 0x99,0xCE,0x35,0xDC, 0x07,0x00,0x00,0x00, 0x00,0x00,0x00,0x02, 0x7D,0x0B,0xCB,0xF2, 0x00,0x00,0x00,0x00, 0x00,0x3F,0xF0,0x00, 0x88,0x38,0x86,0x85, 0x08,0x00,0x00,0x00, 0x00,0x00,0x00,0x1A, 0x6A,0xF6,0x23,0x53, 0x10,0x00,0x00,0x00, 0x00,0x01,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x00,0x01,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x84,0x21,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x84,0x21,0xF5,0x8D, 0x10,0x00,0x00,0x00, 0x42,0x11,0xF5,0x8D, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00};
static uint8_t configBurst0_2[65*4] = {0x80,0x20,0x08,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x44,0x93,0x4F,0xF5, 0x09,0x00,0x00,0x00, 0x00,0x00,0x00,0x28, 0x0D,0xB4,0x3A,0xC9, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x80,0x00,0x00,0x00, 0xFE,0x00,0x00,0x01, 0x00,0x00,0x00,0x01, 0x07,0xFC,0x01,0x04, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x9E,0x02,0x22,0x4A, 0x0D,0x00,0x00,0x00, 0x00,0x00,0x00,0x04, 0x12,0xD0,0x8C,0x8F, 0x02,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x04,0x00,0x80,0x10, 0x00,0x01,0x00,0x20, 0x34,0xE3,0x1D,0x78};
static uint8_t configBurst0_3[39*4] = {0x80,0x20,0x0C,0x00, 0x0E,0x00,0x00,0x00, 0x00,0x00,0x00,0x03, 0xC8,0xA7,0xCE,0xE6, 0x00,0x71,0xC0,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0xC3,0xF7,0x04,0xB9, 0x10,0x00,0x00,0x00, 0x00,0x00,0x00,0x04, 0x8A,0xA0,0xDF,0xBC, 0x80,0x00,0x00,0x00, 0x0D,0xF0,0x3F,0xFB, 0xB2,0xB7,0x80,0x98, 0x40,0x98,0x0D,0xF7, 0xE6,0xC9,0x31,0x8C, 0x11,0x00,0x00,0x00, 0x00,0x00,0x00,0x0B, 0xEF,0xA3,0xE6,0x5A, 0x01,0xC0,0x00,0x00, 0x42,0x04,0x00,0x00, 0xFF,0xFF,0xFC,0x45, 0xFF,0xFF,0xFF,0xFF, 0xFF,0xDD,0x37,0xFF, 0xFF,0xFF,0x00,0x00, 0x00,0x00,0xFF,0xFF, 0x0E,0xFF,0xFF,0xFF, 0x80,0xC2,0x00,0x00, 0x00,0x00,0x03,0x01, 0x45,0x01,0x80,0xC2, 0xD7,0xC6,0x8C,0x8D, 0x4E,0x00,0x00,0x00, 0x00,0x00,0x00,0x01, 0x3A,0x5D,0x5E,0x24, 0x80,0x36,0x00,0x00, 0x45,0xE0,0xCD,0x49, 0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x9D,0xB7,0xE6,0xFD};
#endif

/* Frame format: ADDRESS[32bits] + DATA[32bits] = 64bits
 *
 * ADDRESS[32bits]:
 * B31 B30 B29 B28 B27 B26 B25 B24 B23 B22 B21 B20 B19 B18 B17 B16 B15 B14 B13 B12 B11 B10 B9 B8 B7 B6 B5 B4 B3 B2 B1 B0
 *  1   0   0   0   0   0   0  A20 A19 A18 A17 A16 A15 A14 A13 A12 A11 A10  A9 A8  A7  A6  A5 A4 A3 A2 A1 A0  0  0  0  0
 *
 */
/* Configure CFG_PAD_MIIx_RX[CTRL_IPUD], Pull down MIIx_RX_ER */
/* In MII setting all interface pins must be connected.If unused,RX_ER must be connected to GND
 * or the internal pull up/down must be configured.
 */
static const uint8_t CFG_PAD_MII0_TX[] = {0x01|0x80,0x00,0x80,0x00,0x1a,0x1a,0x1a,0x1a};
static const uint8_t CFG_PAD_MII0_RX[] = {0x01|0x80,0x00,0x80,0x10,0x03,0x03,0x03,0x1b};

static const uint8_t CFG_PAD_MII2_TX[] = {0x01|0x80,0x00,0x80,0x40,0x1a,0x1a,0x1a,0x1a};
static const uint8_t CFG_PAD_MII2_RX[] = {0x01|0x80,0x00,0x80,0x50,0x03,0x03,0x03,0x1b};

static const uint8_t CFG_PAD_MII3_TX[] = {0x01|0x80,0x00,0x80,0x60,0x1a,0x1a,0x1a,0x1a};
static const uint8_t CFG_PAD_MII3_RX[] = {0x01|0x80,0x00,0x80,0x70,0x03,0x03,0x03,0x1b};

static const uint8_t CFG_PAD_MII4_TX[] = {0x01|0x80,0x00,0x80,0x80,0x1a,0x1a,0x1a,0x1a};
static const uint8_t CFG_PAD_MII4_RX[] = {0x01|0x80,0x00,0x80,0x90,0x03,0x03,0x03,0x1b};


//MII 100M clock for port0 (100Mbps MAC)
static const uint8_t port0_idiv0[] =      {0x01|0x80,0x00,0x00,0xb0,0x0a,0x00,0x00,0x01};
static const uint8_t port0_mii_tx_clk[] = {0x01|0x80,0x00,0x01,0x30,0x00,0x00,0x08,0x00};
static const uint8_t port0_mii_rx_clk[] = {0x01|0x80,0x00,0x01,0x40,0x01,0x00,0x08,0x00};

#if 0
//MII clock for port1 (100Mbps MAC)
static const uint8_t port1_idiv1[] =      {0x01|0x80,0x00,0x00,0xc0,0x0a,0x00,0x00,0x01};
static const uint8_t port1_mii_tx_clk[] = {0x01|0x80,0x00,0x01,0x90,0x02,0x00,0x08,0x00};
static const uint8_t port1_mii_rx_clk[] = {0x01|0x80,0x00,0x01,0xa0,0x03,0x00,0x08,0x00};
#endif

//MII clock for port2 (100Mbps MAC)
static const uint8_t port2_idiv2[] =      {0x01|0x80,0x00,0x00,0xd0,0x0a,0x00,0x00,0x01};
static const uint8_t port2_mii_tx_clk[] = {0x01|0x80,0x00,0x01,0xf0,0x04,0x00,0x08,0x00};
static const uint8_t port2_mii_rx_clk[] = {0x01|0x80,0x00,0x02,0x00,0x05,0x00,0x08,0x00};

//MII clock for port3 (100Mbps MAC)
static const uint8_t port3_idiv3[] =      {0x01|0x80,0x00,0x00,0xe0,0x0a,0x00,0x00,0x01};
static const uint8_t port3_mii_tx_clk[] = {0x01|0x80,0x00,0x02,0x50,0x06,0x00,0x08,0x00};
static const uint8_t port3_mii_rx_clk[] = {0x01|0x80,0x00,0x02,0x60,0x07,0x00,0x08,0x00};

//MII clock for port4 (100Mbps PHY)
static const uint8_t port4_idiv4[] =      {0x01|0x80,0x00,0x00,0xf0,0x0a,0x00,0x00,0x00};   // Enable IDIV4 and divide by 1
static const uint8_t port4_mii_tx_clk[] = {0x01|0x80,0x00,0x02,0xb0,0x15,0x00,0x08,0x00};	// CLKSRC of MII_TX_CLK_4 to IDIV4
static const uint8_t port4_mii_rx_clk[] = {0x01|0x80,0x00,0x02,0xc0,0x09,0x00,0x08,0x00};	// Setting CLKSRC of MII_RX_CLK_4 to RX_CLK_4
static const uint8_t port4_ext_tx_clk[] = {0x01|0x80,0x00,0x02,0xf0,0x15,0x00,0x08,0x00};	// Setting CLKSRC of EXT_TX_CLK_4 to IDIV4
static const uint8_t port4_ext_rx_clk[] = {0x01|0x80,0x00,0x03,0x00,0x15,0x00,0x08,0x00};	// Setting CLKSRC of EXT_RX_CLK_4 to IDIV4


/*
@brief
@details
@para
@return
*/
static void SysDelay(uint32_t cnt)
{
	while (cnt--){;}
}

#if (DRIVER_USE_MCAL == 1)
/*
@brief
@details
@para
@return
*/
static int SPI_TransferDataBlocking(const uint8_t* pSrcBuf, uint8_t* pDestBuf, uint16_t Size, uint32_t timeout)
{
	const uint8_t TIMEOUT_THRESHOLD = 5U;
	Std_ReturnType ret = E_NOT_OK;
	Spi_SeqResultType result = SPI_SEQ_FAILED;
	uint8_t dummyCnt = 0;
	uint32_t delayCount = 0;

	ret = Spi_SetupEB(SpiConf_SpiChannel_SJA1105Channel, (Spi_DataType*)pSrcBuf, (Spi_DataType*)pDestBuf, (Spi_NumberOfDataType)Size);

	if (ret == E_OK)
	{
		ret = Spi_AsyncTransmit(SpiConf_SpiSequence_SJA1105Command);

		do
		{
			Spi_MainFunction_Handling();

			result = Spi_GetSequenceResult(SpiConf_SpiSequence_SJA1105Command);

			delayCount++;
		}
		while ((result != SPI_SEQ_OK) && (delayCount <= (timeout * 100)));

		if (result != SPI_SEQ_OK)
		{
			while (dummyCnt < TIMEOUT_THRESHOLD)dummyCnt++;

			return (0);
		}

		while (dummyCnt < TIMEOUT_THRESHOLD)dummyCnt++;

		return (1);
	}
	else
	{
		while (dummyCnt < TIMEOUT_THRESHOLD)dummyCnt++;

		return (0);
	}
}
#endif

/*
@brief Write data to the specified registers in SJA1105 chip.
@details This function is called by users to configure or set the register's value in SJA1105 chip.
@para regAddr, register address in SJA1105 chip.
@para *pWtData, a pointer which point the write data buffer.
@para u8WtDataLen, write data length.The unit of the length is bytes.
@return 0, success; -1, failed;
*/
int SJA1105_WriteData(const uint32_t regAddr, const uint8_t* pWtData, const uint16_t u8WtDataLen)
{
	uint8_t txBuf[65*4], rxBuf[65*4];
	uint16_t length = 0;
#if (DRIVER_USE_SDK == 1)
	status_t retVal;
#elif (DRIVER_USE_MCAL == 1)
	int retVal;
#endif

	txBuf[length++] = (uint8_t)((regAddr >> 20) & 0x000000FFU) | 0x80U;
	txBuf[length++] = (uint8_t)((regAddr >> 12) & 0x000000FFU);
	txBuf[length++] = (uint8_t)((regAddr >> 4)  & 0x000000FFU);
	txBuf[length++] = (uint8_t)((regAddr << 4)  & 0x000000F0U);

	memcpy((uint8_t*)&txBuf[length], (uint8_t*)pWtData, (u8WtDataLen * sizeof(uint8_t)));

	length += (u8WtDataLen * sizeof(uint8_t));

#if (DRIVER_USE_SDK == 1)
	retVal = SPI_MasterTransferBlocking(&spi1Instance, txBuf, rxBuf, length, 1000U);
#elif (DRIVER_USE_MCAL == 1)
	retVal = SPI_TransferDataBlocking(txBuf, rxBuf, length, 1000U);
#endif

#if (DRIVER_USE_SDK == 1)
	if (retVal == STATUS_SUCCESS)
#elif (DRIVER_USE_MCAL == 1)
	if (retVal != 0)
#endif
	{
		return (0);
	}
	else
	{
		return (-1);
	}
}

/*
@brief Read data from the specified registers in SJA1105 chip.
@details This function is called by users to get the register value in SJA1105 chip.
@para regAddr, register address in SJA1105 chip.
@para *pRdData, a pointer which point the read data buffer from SJA1105 chip.
@para u8RdDataLen, read data buffer length.As the register data is 32-bit double words,the length is 4 bytes multiple.
@return 0, success; -1, failed;
*/
int SJA1105_ReadData(const uint32_t regAddr, uint8_t* pRdData, const uint16_t u8RdDataLen)
{
	uint8_t txBuf[65*4], rxBuf[65*4];
	uint16_t length = 0;
	uint8_t size;
#if (DRIVER_USE_SDK == 1)
	status_t retVal;
#elif (DRIVER_USE_MCAL == 1)
	int retVal;
#endif

	size = (uint8_t)(u8RdDataLen / 4);

	txBuf[length++] = (uint8_t)((regAddr >> 20) & 0x000000FFU) | (size << 1);
	txBuf[length++] = (uint8_t)((regAddr >> 12) & 0x000000FFU);
	txBuf[length++] = (uint8_t)((regAddr >> 4)  & 0x000000FFU);
	txBuf[length++] = (uint8_t)((regAddr << 4)  & 0x000000F0U);

	memset((uint8_t*)&txBuf[length], 0, (u8RdDataLen * sizeof(uint8_t)));

	length += (u8RdDataLen * sizeof(uint8_t));

#if (DRIVER_USE_SDK == 1)
	retVal = SPI_MasterTransferBlocking(&spi1Instance, txBuf, rxBuf, length, 1000U);
#elif (DRIVER_USE_MCAL == 1)
	retVal = SPI_TransferDataBlocking(txBuf, rxBuf, length, 1000U);
#endif

#if (DRIVER_USE_SDK == 1)
	if (retVal == STATUS_SUCCESS)
#elif (DRIVER_USE_MCAL == 1)
	if (retVal != 0)
#endif
	{
		memcpy((uint8_t*)pRdData, (uint8_t*)&rxBuf[4], (u8RdDataLen * sizeof(uint8_t)));

		return (0);
	}
	else
	{
		memset((uint8_t*)pRdData, 0, (u8RdDataLen * sizeof(uint8_t)));

		return (-1);
	}
}


/*
@brief
@details
@para
@return
*/
int SJA1105_ResetChip(void)
{
	uint32_t wtData;
	uint32_t timeoutCnt;

	/* Unlock or enable write access to reset control register. */
	wtData = 0x00U;
	if (SJA1105_WriteData(UNIT_DISABLE_REG_FOR_RGU, (uint8_t*)&wtData, (sizeof(wtData)/sizeof(uint8_t))) != 0)return (0);

	/* Perform a reset. */
	wtData  = 0;
	wtData |= (RESET_CTRL_POR_RST_MASK | RESET_CTRL_COLD_RST_MASK | RESET_CTRL_WARM_RST_MASK);
	if (SJA1105_WriteData(RESET_CTRL_REG, (uint8_t*)&wtData, (sizeof(wtData)/sizeof(uint8_t))) != 0)return (0);

	/* Wait reset completely. */
	timeoutCnt = 0;
	while (((wtData & (RESET_CTRL_POR_RST_MASK | RESET_CTRL_COLD_RST_MASK | RESET_CTRL_WARM_RST_MASK)) != 0) && (timeoutCnt < 0x10000000U))
	{
		SJA1105_ReadData(RESET_CTRL_REG, (uint8_t*)&wtData, (sizeof(wtData)/sizeof(uint8_t)));
		timeoutCnt++;
	}
	if (timeoutCnt >= 0x10000000U)
	{
		return (0);
	}

	/* Lock or disable write access to reset control register. */
	wtData = 0x01U;
	if (SJA1105_WriteData(UNIT_DISABLE_REG_FOR_RGU, (uint8_t*)&wtData, (sizeof(wtData)/sizeof(uint8_t))) != 0)return (0);

	return (1);
}

/*
@brief
@details
@para
@return
*/
void SJA1105_Init(void)
{
	/* Pull down SJA1105_RESET pin to reset SJA1105 chip. */
	SWITCH_SJA1105_RESET_LOW();
	/* Delay */
	SysDelay(500000);
	/* After reset process complete,pull up SJA1105_RESET pin. */
	SWITCH_SJA1105_RESET_HIGH();

	Spi_Init((Spi_ConfigType *)&SpiDriver);
	Spi_SetAsyncMode(SPI_POLLING_MODE);

	SJA1105_ResetChip();

	/*------------------------------ SWITCH AND ENET PHY - MAC0 -------------------------*/
	SPI_TransferDataBlocking(CFG_PAD_MII0_TX, r_data, (sizeof(CFG_PAD_MII0_TX)/sizeof(uint8_t)), 1000U);
	SPI_TransferDataBlocking(CFG_PAD_MII0_RX, r_data, (sizeof(CFG_PAD_MII0_RX)/sizeof(uint8_t)), 1000U);

	SPI_TransferDataBlocking(CFG_PAD_MII2_TX, r_data, (sizeof(CFG_PAD_MII2_TX)/sizeof(uint8_t)), 1000U);
	SPI_TransferDataBlocking(CFG_PAD_MII2_RX, r_data, (sizeof(CFG_PAD_MII2_RX)/sizeof(uint8_t)), 1000U);

	SPI_TransferDataBlocking(CFG_PAD_MII3_TX, r_data, (sizeof(CFG_PAD_MII3_TX)/sizeof(uint8_t)), 1000U);
	SPI_TransferDataBlocking(CFG_PAD_MII3_RX, r_data, (sizeof(CFG_PAD_MII3_RX)/sizeof(uint8_t)), 1000U);

	SPI_TransferDataBlocking(CFG_PAD_MII4_TX, r_data, (sizeof(CFG_PAD_MII4_TX)/sizeof(uint8_t)), 1000U);
	SPI_TransferDataBlocking(CFG_PAD_MII4_RX, r_data, (sizeof(CFG_PAD_MII4_RX)/sizeof(uint8_t)), 1000U);

	/*****************************************port0**************************************************/
	//port0 port0_idiv0 MII-MAC
	SPI_TransferDataBlocking(port0_idiv0, r_data, (sizeof(port0_idiv0)/sizeof(uint8_t)), 1000U);

	//port0 port0_mii_tx_clk MII-MAC
	SPI_TransferDataBlocking(port0_mii_tx_clk, r_data, (sizeof(port0_mii_tx_clk)/sizeof(uint8_t)), 1000U);

	//port0 port0_mii_rx_clk MII-MAC
	SPI_TransferDataBlocking(port0_mii_rx_clk, r_data, (sizeof(port0_mii_rx_clk)/sizeof(uint8_t)), 1000U);

#if 0
	/*****************************************port1**************************************************/
	//port1 port1_idiv1 MII-MAC
//	SPI_TransferDataBlocking(port1_idiv1, r_data, (sizeof(port1_idiv1)/sizeof(uint8_t)), 1000U);
//
//	//port1 port1_mii_tx_clk MII-MAC
//	SPI_TransferDataBlocking(port1_mii_tx_clk, r_data, (sizeof(port1_mii_tx_clk)/sizeof(uint8_t)), 1000U);
//
//	//port1 port1_mii_rx_clk MII-MAC
//	SPI_TransferDataBlocking(port1_mii_rx_clk, r_data, (sizeof(port1_mii_rx_clk)/sizeof(uint8_t)), 1000U);
#endif

	/*****************************************port2**************************************************/
	//port2 port2_idiv2 MII-MAC
	SPI_TransferDataBlocking(port2_idiv2, r_data, (sizeof(port2_idiv2)/sizeof(uint8_t)), 1000U);

	//port2 port2_mii_tx_clk MII-MAC
	SPI_TransferDataBlocking(port2_mii_tx_clk, r_data, (sizeof(port2_mii_tx_clk)/sizeof(uint8_t)), 1000U);

	//port2 port2_mii_rx_clk MII-MAC
	SPI_TransferDataBlocking(port2_mii_rx_clk, r_data, (sizeof(port2_mii_rx_clk)/sizeof(uint8_t)), 1000U);

	/*****************************************port3**************************************************/
	//port3 port3_idiv3 MII-MAC
	SPI_TransferDataBlocking(port3_idiv3, r_data, (sizeof(port3_idiv3)/sizeof(uint8_t)), 1000U);

	//port3 port3_mii_tx_clk MII-MAC
	SPI_TransferDataBlocking(port3_mii_tx_clk, r_data, (sizeof(port3_mii_tx_clk)/sizeof(uint8_t)), 1000U);

	//port3 port3_mii_rx_clk MII-MAC
	SPI_TransferDataBlocking(port3_mii_rx_clk, r_data, (sizeof(port3_mii_rx_clk)/sizeof(uint8_t)), 1000U);

	/*****************************************port4**************************************************/
	//port4 port4_idiv4 MII-PHY
	SPI_TransferDataBlocking(port4_idiv4, r_data, (sizeof(port4_idiv4)/sizeof(uint8_t)), 1000U);

	//port4 port4_mii_tx_clk MII-PHY
	SPI_TransferDataBlocking(port4_mii_tx_clk, r_data, (sizeof(port4_mii_tx_clk)/sizeof(uint8_t)), 1000U);

	//port4 port4_mii_rx_clk MII-PHY
	SPI_TransferDataBlocking(port4_mii_rx_clk, r_data, (sizeof(port4_mii_rx_clk)/sizeof(uint8_t)), 1000U);

	//port4 port4_ext_tx_clk MII-PHY
	SPI_TransferDataBlocking(port4_ext_tx_clk, r_data, (sizeof(port4_ext_tx_clk)/sizeof(uint8_t)), 1000U);

	//port4 port4_ext_rx_clk MII-PHY
	SPI_TransferDataBlocking(port4_ext_rx_clk, r_data, (sizeof(port4_ext_rx_clk)/sizeof(uint8_t)), 1000U);

	/*****************************************static configuration**************************************************/
	SPI_TransferDataBlocking(configBurst0_0, r_data, (sizeof(configBurst0_0)/sizeof(uint8_t)), 1000U);

	SPI_TransferDataBlocking(configBurst0_1, r_data, (sizeof(configBurst0_1)/sizeof(uint8_t)), 1000U);

	SPI_TransferDataBlocking(configBurst0_2, r_data, (sizeof(configBurst0_2)/sizeof(uint8_t)), 1000U);

	SPI_TransferDataBlocking(configBurst0_3, r_data, (sizeof(configBurst0_3)/sizeof(uint8_t)), 1000U);
}


/*
@brief Checking SJA1105 chip configuration status and chip type.
@para *pDevType, SJA1105 device type;
@para *pDevConfigSta, SJA1105 configuration result status.
@return 0, failed; 1, success;
*/
int SJA1105_ConfigStatusChecking(SJA1105TypeDef* pDevType, SJA1105ConfigStatus* pDevConfigSta)
{
	SJA1105TypeDef DevType = DEVICE_NONE;
	SJA1105ConfigStatus DevConfigSta = CONFIG_INVALID;
	int retVal = 0;
	uint8_t rxBuf[4];
	uint32_t rxData;

	if (SJA1105_ReadData(DEVICE_CONFIGFLAG_REG, rxBuf, (sizeof(rxBuf)/sizeof(uint8_t))) == 0)
	{
		rxData = ((uint32_t)rxBuf[0] << 24) + ((uint32_t)rxBuf[1] << 16) + ((uint32_t)rxBuf[2] << 8) + rxBuf[3];

		if (rxData & DEVICE_CONFIGFLAG_REG_CONFIGS_MASK)
		{
			/* CRC check OK? */
			if (((rxData & DEVICE_CONFIGFLAG_REG_CRCCHKL_MASK) == 0) && ((rxData & DEVICE_CONFIGFLAG_REG_CRCCHKG_MASK) == 0))
			{
				if ((rxData & DEVICE_CONFIGFLAG_REG_IDS_MASK) == 0)
				{
					if (SJA1105_ReadData(DEVICE_PROD_ID_REG, rxBuf, (sizeof(rxBuf)/sizeof(uint8_t))) == 0)
					{
						rxData = ((uint32_t)rxBuf[0] << 24) + ((uint32_t)rxBuf[1] << 16) + ((uint32_t)rxBuf[2] << 8) + rxBuf[3];

						rxData = (rxData & DEVICE_PROD_ID_REG_PART_NR_MASK) >> 4;

						switch (rxData)
						{
							case SJA1105PEL_PROD_ID_PARTNR: DevType = DEVICE_SJA1105PEL;break;
							case SJA1105QEL_PROD_ID_PARTNR: DevType = DEVICE_SJA1105QEL;break;
							case SJA1105REL_PROD_ID_PARTNR: DevType = DEVICE_SJA1105REL;break;
							case SJA1105SEL_PROD_ID_PARTNR: DevType = DEVICE_SJA1105SEL;break;
							default:break;
						}

						DevConfigSta = CONFIG_VALID;

						retVal = 1;
					}
				}
			}
		}
	}

	*pDevType = DevType;
	*pDevConfigSta = DevConfigSta;

	return (retVal);
}





